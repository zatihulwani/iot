{"remainingRequest":"/Applications/XAMPP/xamppfiles/htdocs/contoh/node_modules/vue-loader/lib/index.js??vue-loader-options!/Applications/XAMPP/xamppfiles/htdocs/contoh/src/views/Login.vue?vue&type=script&lang=js&","dependencies":[{"path":"/Applications/XAMPP/xamppfiles/htdocs/contoh/src/views/Login.vue","mtime":1554002966000},{"path":"/Applications/XAMPP/xamppfiles/htdocs/contoh/node_modules/cache-loader/dist/cjs.js","mtime":499162500000},{"path":"/Applications/XAMPP/xamppfiles/htdocs/contoh/node_modules/babel-loader/lib/index.js","mtime":499162500000},{"path":"/Applications/XAMPP/xamppfiles/htdocs/contoh/node_modules/cache-loader/dist/cjs.js","mtime":499162500000},{"path":"/Applications/XAMPP/xamppfiles/htdocs/contoh/node_modules/vue-loader/lib/index.js","mtime":499162500000}],"contextDependencies":[],"result":["//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n\nimport { mapGetters, mapActions } from 'vuex';\nimport GetAllUser from '../components/GetAllUser.vue';\nimport ax from '../services/ApiService';\n\nexport default {\n  components: {\n    'get-all-user': GetAllUser\n  },\n  data() {\n    return {\n      // username: \"bgsbla33333@gmail.com\",\n      password: 'bagaskarala',\n      loading: false,\n      email: {\n        admin: 'bgsbla33333@gmail.com',\n        staff: 'bagaskara_staff@gmail.com'\n      },\n      selectedUser: 'bgsbla33333@gmail.com',\n      errorMessage: ''\n    };\n  },\n  computed: {\n    ...mapGetters(['jwt', 'loggedIn']),\n    username: {\n      get: function() {\n        return this.selectedUser;\n      },\n      set: function(val) {\n        this.selectedUser = val;\n      }\n    }\n  },\n\n  methods: {\n    ...mapActions(['fetchJWT', 'fetchProfile', 'removeAuth']),\n\n    onChange(event) {\n      console.log('e target', event.target.value);\n      console.log('this name', this.username);\n    },\n\n    async login() {\n      console.log('logging in');\n      if (this.username == '' || this.password == '') {\n        alert('isi username dan password dahulu');\n        return false;\n      }\n      this.loading = true;\n\n      //fetch JWT\n      const responseJWT = await this.fetchJWT({\n        username: this.username,\n        password: this.password\n      });\n\n      //error handling\n      if (responseJWT != null) {\n        //check whether success login\n        if (responseJWT.status == 200) {\n          //fetch profile after got JWT\n          const responseProfile = await this.fetchProfile();\n          //check whether success get profile\n          if (responseProfile.status == 200) {\n            this.loading = false;\n            console.log('authenticated from api login');\n            //check redirect parameter in url\n            if (this.$route.query.redirect != null) {\n              this.$router.push(this.$route.query.redirect);\n            } else {\n              //check if user is admin\n              if (responseProfile.data.data.role.id == 1) {\n                this.$router.push('admin');\n              } else {\n                this.$router.push('user');\n              }\n            }\n          } else {\n            //failed get profile\n            this.loading = false;\n            console.log('gagal fetch profile,status selain 200');\n            this.errorMessage = responseProfile.data;\n          }\n        } else {\n          //failed get token\n          this.loading = false;\n          console.log('Failed fetch JWT');\n          this.errorMessage = responseJWT.data;\n        }\n      } else {\n        //failed contact server\n        this.loading = false;\n        this.errorMessage = 'Connection Error';\n      }\n    },\n\n    logout() {\n      const removeAuth = this.removeAuth();\n      if (removeAuth) {\n        console.log('logged out');\n      }\n    },\n\n    getAllDevices() {\n      ax.getDevice()\n        .then(function(response) {\n          console.log(response);\n        })\n        .catch(function(error) {\n          console.log(error);\n        });\n    }\n  }\n};\n",{"version":3,"sources":["Login.vue"],"names":[],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AAgDA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA","file":"Login.vue","sourceRoot":"src/views","sourcesContent":["<template>\n  <div>\n    <h3>Form Login</h3>\n    <p>\n      <label for=\"selectUsername\">Pilih username :</label>\n      <select\n        name=\"selectUsername\"\n        id=\"selectUsername\"\n        v-model=\"username\"\n        :disabled=\"loggedIn == 1\"\n        @change=\"onChange\"\n      >\n        <option :value=\"email.admin\">email admin</option>\n        <option :value=\"email.staff\">email staff</option>\n      </select>\n    </p>\n    <form>\n      <input type=\"text\" v-model=\"username\" :disabled=\"loggedIn == 1\">\n      <input type=\"password\" v-model=\"password\" :disabled=\"loggedIn == 1\">\n      <button type=\"submit\" @click.prevent=\"login\" :disabled=\"loggedIn == 1\">Login</button>\n      <p>\n        <button type=\"button\" @click.prevent=\"logout\" :disabled=\"loggedIn == 0\">logout</button>\n      </p>\n    </form>\n    <p v-show=\"loading\" id=\"loading\">Loading</p>\n    <p class=\"error\">{{errorMessage}}</p>\n    <hr>\n    <h3 v-if=\"loggedIn\">Status</h3>\n    <div id=\"statusLogin\">\n      <p>\n        <strong>JWT token type</strong>\n        : {{jwt.token_type}}\n      </p>\n      <p>\n        <strong>access token</strong>\n        : {{jwt.access_token}}\n      </p>\n      <p>\n        <strong>expires in</strong>\n        : {{jwt.expires_in}}\n      </p>\n    </div>\n    <hr>\n    <get-all-user v-if=\"loggedIn\" :access_token=\"jwt.access_token\"></get-all-user>\n  </div>\n</template>\n\n<script>\nimport { mapGetters, mapActions } from 'vuex';\nimport GetAllUser from '../components/GetAllUser.vue';\nimport ax from '../services/ApiService';\n\nexport default {\n  components: {\n    'get-all-user': GetAllUser\n  },\n  data() {\n    return {\n      // username: \"bgsbla33333@gmail.com\",\n      password: 'bagaskarala',\n      loading: false,\n      email: {\n        admin: 'bgsbla33333@gmail.com',\n        staff: 'bagaskara_staff@gmail.com'\n      },\n      selectedUser: 'bgsbla33333@gmail.com',\n      errorMessage: ''\n    };\n  },\n  computed: {\n    ...mapGetters(['jwt', 'loggedIn']),\n    username: {\n      get: function() {\n        return this.selectedUser;\n      },\n      set: function(val) {\n        this.selectedUser = val;\n      }\n    }\n  },\n\n  methods: {\n    ...mapActions(['fetchJWT', 'fetchProfile', 'removeAuth']),\n\n    onChange(event) {\n      console.log('e target', event.target.value);\n      console.log('this name', this.username);\n    },\n\n    async login() {\n      console.log('logging in');\n      if (this.username == '' || this.password == '') {\n        alert('isi username dan password dahulu');\n        return false;\n      }\n      this.loading = true;\n\n      //fetch JWT\n      const responseJWT = await this.fetchJWT({\n        username: this.username,\n        password: this.password\n      });\n\n      //error handling\n      if (responseJWT != null) {\n        //check whether success login\n        if (responseJWT.status == 200) {\n          //fetch profile after got JWT\n          const responseProfile = await this.fetchProfile();\n          //check whether success get profile\n          if (responseProfile.status == 200) {\n            this.loading = false;\n            console.log('authenticated from api login');\n            //check redirect parameter in url\n            if (this.$route.query.redirect != null) {\n              this.$router.push(this.$route.query.redirect);\n            } else {\n              //check if user is admin\n              if (responseProfile.data.data.role.id == 1) {\n                this.$router.push('admin');\n              } else {\n                this.$router.push('user');\n              }\n            }\n          } else {\n            //failed get profile\n            this.loading = false;\n            console.log('gagal fetch profile,status selain 200');\n            this.errorMessage = responseProfile.data;\n          }\n        } else {\n          //failed get token\n          this.loading = false;\n          console.log('Failed fetch JWT');\n          this.errorMessage = responseJWT.data;\n        }\n      } else {\n        //failed contact server\n        this.loading = false;\n        this.errorMessage = 'Connection Error';\n      }\n    },\n\n    logout() {\n      const removeAuth = this.removeAuth();\n      if (removeAuth) {\n        console.log('logged out');\n      }\n    },\n\n    getAllDevices() {\n      ax.getDevice()\n        .then(function(response) {\n          console.log(response);\n        })\n        .catch(function(error) {\n          console.log(error);\n        });\n    }\n  }\n};\n</script>\n<style scoped>\n.error {\n  background-color: red;\n  padding: 10px;\n  color: white;\n}\n#statusLogin {\n  background-color: lightgreen;\n  padding: 10px;\n  margin: 10px;\n}\n#loading {\n  color: crimson;\n  font-weight: bolder;\n}\n</style>\n"]}]}